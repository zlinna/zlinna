{"title":"MySQL 使用及调优","date":"2019-05-20T15:34:08.724Z","date_formatted":{"ll":"May 20, 2019","L":"05/20/2019","MM-DD":"05-20"},"link":"2019/05/20/MySQL使用及调优","tags":["MySQL"],"updated":"2019-12-14T12:27:46.783Z","content":"<h2><span id=\"数据库使用-调优\">数据库使用、调优</span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h2><ol>\n<li><a href=\"2019/05/20/MySQL使用及调优#1\">检索数据 select</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#2\">排序数据 order by</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#3\">过滤数据 where</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#4\">数据过滤 where and / or / in / not in</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#5\">模糊查询 like</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#6\">正则匹配 regexp</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#7\">创建计算字段 concat / trim</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#8\">使用函数</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#9\">分组/过滤 group by / having</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#10\">使用子查询</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#11\">联结表 join</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#12\">组合查询 union</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#13\">插入数据 insert</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#14\">更新和删除数据 update/delete</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#15\">创建和操作表 create/alter/references</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#16\">使用视图 view</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#17\">存储过程/游标/触发器/事务处理</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#18\">全球化和本地化/安全管理/数据库维护</a></li>\n<li><a href=\"2019/05/20/MySQL使用及调优#19\">改善性能</a></li>\n</ol>\n<a id=\"more\"></a>\n<h3><span id=\"1-检索数据-select\"><span id=\"1\">1 检索数据 select</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> prod_name <span class=\"keyword\">from</span> products;  <span class=\"comment\"># 检索单列</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_id, prod_name, prod_price <span class=\"keyword\">from</span> products;  <span class=\"comment\"># 检索多列</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> * <span class=\"keyword\">from</span> products;  <span class=\"comment\"># 检索所有列</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"keyword\">distinct</span> prod_id <span class=\"keyword\">from</span> products;  <span class=\"comment\"># 检索不同的行（去重）</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_name <span class=\"keyword\">from</span> products <span class=\"keyword\">limit</span> <span class=\"number\">5</span>;  <span class=\"comment\"># 检索单列的前5条记录</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> products.prod_name <span class=\"keyword\">from</span> products;  <span class=\"comment\"># 使用限定表名检索单列</span></span><br></pre></td></tr></table></div></figure>\n<h3><span id=\"2-排序数据-select-语句的-order-by-子句默认生序\"><span id=\"2\">2 排序数据 select 语句的 order by 子句（默认生序）</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 检索单列并按 prod_name 字段进行排序</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_name <span class=\"keyword\">from</span> products <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> prod_name;</span><br><span class=\"line\"><span class=\"comment\"># 检索多列，并按多列先后进行排序</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_id, prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> prod_price, prod_name;</span><br><span class=\"line\"><span class=\"comment\"># 先按 prod_price 升序，再按 prod_name 降序</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_id, prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> prod_price, prod_name <span class=\"keyword\">desc</span>;</span><br><span class=\"line\"><span class=\"comment\"># 先按 prod_price 降序，再按 prod_name 升序</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_id, prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> prod_price <span class=\"keyword\">desc</span>, prod_name;</span><br></pre></td></tr></table></div></figure>\n<h3><span id=\"3-过滤数据-select-语句的-where-子句\"><span id=\"3\">3 过滤数据 select 语句的 where 子句</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 检查单个值</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">where</span> proc_name = <span class=\"string\">\"banana\"</span>;</span><br><span class=\"line\"><span class=\"comment\"># 不匹配检查</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">where</span> proc_name != <span class=\"string\">\"banana\"</span>;</span><br><span class=\"line\"><span class=\"comment\"># 范围值检查</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">where</span> prod_price <span class=\"keyword\">between</span> <span class=\"number\">5</span> <span class=\"keyword\">and</span> <span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"comment\"># 空值检查</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">where</span> prod_name <span class=\"keyword\">is</span> <span class=\"literal\">null</span>;</span><br></pre></td></tr></table></div></figure>\n<h3><span id=\"4-数据过滤-select-语句的-where-子句的andor-innot-in子句\"><span id=\"4\">4 数据过滤 select 语句的 where 子句的（and/or、in/not in）子句</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># and 操作符</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_id, prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">where</span> prod_id = <span class=\"number\">1001</span> <span class=\"keyword\">and</span> prod_price &lt;= <span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"comment\"># or 操作符</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_id, prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">where</span> prod_id = <span class=\"number\">1001</span> <span class=\"keyword\">or</span> prod_id = <span class=\"number\">1002</span>;</span><br><span class=\"line\"><span class=\"comment\"># 计算次序问题（先计算 and ，在计算 or ）</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_id, prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">where</span> (prod_id = <span class=\"number\">1001</span> <span class=\"keyword\">or</span> prod_id = <span class=\"number\">1002</span>) <span class=\"keyword\">and</span> prod_price &lt;= <span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"comment\"># in 操作符</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_id, prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">where</span> prod_id <span class=\"keyword\">in</span> (<span class=\"number\">1001</span>, <span class=\"number\">1002</span>) <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> prod_name;</span><br><span class=\"line\"><span class=\"comment\"># not in 操作符</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_id, prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">where</span> prod_id <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> (<span class=\"number\">1001</span>, <span class=\"number\">1002</span>) <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> prod_name;</span><br></pre></td></tr></table></div></figure>\n<h3><span id=\"5-通配符过滤模糊查询select-语句的-where-子句的-like-子句\"><span id=\"5\">5 通配符过滤（模糊查询）select 语句的 where 子句的 like 子句</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 尽量不使用模糊查询</span></span><br><span class=\"line\"><span class=\"comment\"># % 通配符，匹配任意次数(包括 0 次)</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">where</span> prod_name <span class=\"keyword\">like</span> <span class=\"string\">\"bana%\"</span></span><br><span class=\"line\"><span class=\"comment\"># _ 通配符，匹配单次</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">where</span> prod_name <span class=\"keyword\">like</span> <span class=\"string\">\"_anan_\"</span></span><br></pre></td></tr></table></div></figure>\n<h3><span id=\"6-正则匹配-select-语句的-where-子句的-regexp-子句\"><span id=\"6\">6 正则匹配 select 语句的 where 子句的 regexp 子句</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ...</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> prod_name <span class=\"keyword\">from</span> products <span class=\"keyword\">where</span> prod_name regexp <span class=\"string\">'\\\\([0-9] sticks?\\\\)'</span> <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> prod_name;</span><br><span class=\"line\"><span class=\"comment\"># prod_name</span></span><br><span class=\"line\"><span class=\"comment\"># TNT (1 stick</span></span><br><span class=\"line\"><span class=\"comment\"># TNT (5 sticks)</span></span><br></pre></td></tr></table></div></figure>\n<h3><span id=\"7-创建计算字段-concattrim\"><span id=\"7\">7 创建计算字段 concat/trim</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 创建拼接字段 concat</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"keyword\">concat</span>(vend_name, <span class=\"string\">' ('</span>,vend_country, <span class=\"string\">')'</span>) <span class=\"keyword\">from</span> venders <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> vend_name;</span><br><span class=\"line\"><span class=\"comment\"># 使用别名 as</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"keyword\">concat</span>(vend_name, <span class=\"string\">' ('</span>,vend_country, <span class=\"string\">')'</span>) <span class=\"keyword\">as</span> vend_info <span class=\"keyword\">from</span> venders <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> vend_name;</span><br><span class=\"line\"><span class=\"comment\"># 去除空格 trim/ltrim/rtrim</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"keyword\">concat</span>(<span class=\"keyword\">rtrim</span>(vend_name), <span class=\"string\">' ('</span>,vend_country, <span class=\"string\">')'</span>) <span class=\"keyword\">from</span> venders;</span><br><span class=\"line\"><span class=\"comment\"># 执行算数计算 + - * /</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> item_price, quantity, item_price*quantity <span class=\"keyword\">as</span> expanded_price <span class=\"keyword\">from</span> items;</span><br></pre></td></tr></table></div></figure>\n<h3><span id=\"8-使用数据处理汇总函数\"><span id=\"8\">8 使用数据处理/汇总函数</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># trim 函数</span></span><br><span class=\"line\"><span class=\"comment\"># upper/lower/length</span></span><br><span class=\"line\"><span class=\"comment\"># date/now</span></span><br><span class=\"line\"><span class=\"comment\"># abs/mod/rand/sin/cos/tan/sqrt</span></span><br><span class=\"line\"><span class=\"comment\"># count/avg/max/min/sum</span></span><br><span class=\"line\"><span class=\"comment\"># ...</span></span><br></pre></td></tr></table></div></figure>\n<h3><span id=\"9-分组数据-select-语句的-group-by-having-子句\"><span id=\"9\">9 分组数据 select 语句的 group by / having 子句</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># group by 分组</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> vent_id, <span class=\"keyword\">count</span>(*) <span class=\"keyword\">as</span> num_prods <span class=\"keyword\">from</span> products <span class=\"keyword\">group</span> <span class=\"keyword\">by</span> vent_id;</span><br><span class=\"line\"><span class=\"comment\"># vent_id | num_prods</span></span><br><span class=\"line\"><span class=\"comment\"># 1002    | 3</span></span><br><span class=\"line\"><span class=\"comment\"># 1003    | 7</span></span><br><span class=\"line\"><span class=\"comment\"># 1004    | 2</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># having 过滤</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> vent_id, <span class=\"keyword\">count</span>(*) <span class=\"keyword\">as</span> num_prods <span class=\"keyword\">from</span> products <span class=\"keyword\">group</span> <span class=\"keyword\">by</span> vent_id <span class=\"keyword\">having</span> vent_id &lt;= <span class=\"number\">2</span>;</span><br><span class=\"line\"><span class=\"comment\"># vent_id | num_prods</span></span><br><span class=\"line\"><span class=\"comment\"># 1004    | 2</span></span><br></pre></td></tr></table></div></figure>\n<h3><span id=\"10-使用子查询-select-语句的-select-子句\"><span id=\"10\">10 使用子查询 select 语句的 select 子句</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> cust_id <span class=\"keyword\">from</span> orders <span class=\"keyword\">where</span> order_num <span class=\"keyword\">in</span> (</span><br><span class=\"line\">    <span class=\"keyword\">select</span> order_num <span class=\"keyword\">from</span> orderitems <span class=\"keyword\">where</span> proc_id = <span class=\"number\">1002</span>)</span><br></pre></td></tr></table></div></figure>\n<h3><span id=\"11-联结表-join\"><span id=\"11\">11 联结表 join</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><ul>\n<li>inner join  两表交集</li>\n<li>left join  左表（若左右表相同，去重，添加剩余的左表数据）</li>\n<li>right join  右表</li>\n<li>where 多表连结</li>\n<li>left outer join</li>\n<li>right outer join</li>\n<li>full outer join</li>\n</ul>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> prod_id, prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">inner</span> <span class=\"keyword\">join</span> items <span class=\"keyword\">on</span> products.prod_name = items.prod_name;</span><br></pre></td></tr></table></div></figure>\n<h3><span id=\"12-组合查询-union\"><span id=\"12\">12 组合查询 union</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><ul>\n<li>多条查询语句的字段要一致</li>\n<li>union 去重</li>\n<li>union all 不去重</li>\n</ul>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> prod_id, prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">where</span> prod_id &lt;= <span class=\"number\">10000</span> <span class=\"keyword\">union</span></span><br><span class=\"line\">    <span class=\"keyword\">select</span> prod_id, prod_name, prod_price <span class=\"keyword\">from</span> products <span class=\"keyword\">where</span> prod_price &lt;= <span class=\"number\">100</span>;</span><br></pre></td></tr></table></div></figure>\n<h3><span id=\"13-插入数据-insert\"><span id=\"13\">13 插入数据 insert</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 插入完整的行</span></span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> products <span class=\"keyword\">values</span>(<span class=\"number\">1</span>, <span class=\"string\">\"apple\"</span>, <span class=\"number\">9</span>);</span><br><span class=\"line\"><span class=\"comment\"># 插入行的一部分</span></span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> products(prod_name, prod_price) <span class=\"keyword\">values</span>(<span class=\"string\">\"egg\"</span>, <span class=\"number\">1.5</span>);</span><br><span class=\"line\"><span class=\"comment\"># 插入多行</span></span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> products <span class=\"keyword\">values</span>(<span class=\"number\">1</span>, <span class=\"string\">\"apple\"</span>, <span class=\"number\">9</span>),(<span class=\"number\">4</span>, <span class=\"string\">\"egg\"</span>, <span class=\"number\">1.5</span>);</span><br><span class=\"line\"><span class=\"comment\"># 插入某些查询的结果</span></span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> products(prod_id, prod_name, prod_price) <span class=\"keyword\">select</span> prod_id, prod_name, prod_price <span class=\"keyword\">from</span> products;</span><br></pre></td></tr></table></div></figure>\n<h3><span id=\"14-更新和删除数据-updatedelete\"><span id=\"14\">14 更新和删除数据 update/delete</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">update</span> products <span class=\"keyword\">set</span> prod_name = <span class=\"string\">\"apple_banana\"</span> <span class=\"keyword\">where</span> prod_id = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">update</span> products <span class=\"keyword\">set</span> prod_name = <span class=\"string\">\"apple_banana\"</span>, prod_price = <span class=\"number\">10</span> <span class=\"keyword\">where</span> prod_id = <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">delete</span> <span class=\"keyword\">from</span> products <span class=\"keyword\">where</span> prod_id = <span class=\"number\">1</span>;</span><br></pre></td></tr></table></div></figure>\n<h3><span id=\"15-创建和操作表-createalterreferences\"><span id=\"15\">15 创建和操作表 create/alter/references</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 创建表</span></span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">table</span> products (</span><br><span class=\"line\">    prod_id <span class=\"built_in\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">not</span> <span class=\"literal\">null</span> auto_increment,</span><br><span class=\"line\">    prod_name <span class=\"built_in\">varchar</span>(<span class=\"number\">64</span>) <span class=\"keyword\">not</span> <span class=\"literal\">null</span>,</span><br><span class=\"line\">    prod_price <span class=\"built_in\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">not</span> <span class=\"literal\">null</span> <span class=\"keyword\">default</span> <span class=\"number\">10</span>,</span><br><span class=\"line\">    primary <span class=\"keyword\">key</span> (prod_id)</span><br><span class=\"line\">    <span class=\"comment\"># primary key (prod_id, prod_name)  # 组合是唯一的</span></span><br><span class=\"line\">)<span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">InnoDB</span>;</span><br><span class=\"line\"><span class=\"comment\"># )ENGINE=MyISAM;  # 不支持事务操作</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 更新表</span></span><br><span class=\"line\"><span class=\"keyword\">alter</span> <span class=\"keyword\">table</span> products <span class=\"keyword\">add</span> prod_number <span class=\"built_in\">int</span>(<span class=\"number\">11</span>);</span><br><span class=\"line\"><span class=\"keyword\">alter</span> <span class=\"keyword\">table</span> products <span class=\"keyword\">drop</span> colume prod_number;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 删除表</span></span><br><span class=\"line\"><span class=\"keyword\">drop</span> <span class=\"keyword\">table</span> products;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 重命名表</span></span><br><span class=\"line\"><span class=\"keyword\">rename</span> <span class=\"keyword\">table</span> products <span class=\"keyword\">to</span> products_new;</span><br><span class=\"line\"><span class=\"keyword\">rename</span> <span class=\"keyword\">table</span> products <span class=\"keyword\">to</span> products_new, items <span class=\"keyword\">to</span> items_new;</span><br></pre></td></tr></table></div></figure>\n<h3><span id=\"16-使用视图-view\"><span id=\"16\">16 使用视图 view</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><ol>\n<li>视图用CREATE VIEW语句来创建</li>\n<li>使用SHOW CREATE VIEW viewname;来查看创建视图的语句</li>\n<li>用DROP删除视图，其语法为DROP VIEW viewname;</li>\n<li>更新视图时，可以先用DROP再用CREATE，也可以直接用CREATE OR REPLACE VIEW。如果要更新的视图不存在，则第2条更新语句会创 建一个视图;如果要更新的视图存在，则第2条更新语句会替换原 有视图</li>\n</ol>\n<h3><span id=\"17-存储过程游标触发器事务处理\"><span id=\"17\">17 存储过程/游标/触发器/事务处理</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><ul>\n<li>使用存储过程 procedure</li>\n<li>使用游标</li>\n<li>使用触发器</li>\n<li>事务处理</li>\n</ul>\n<h3><span id=\"18-全球化和本地化安全管理数据库维护\"><span id=\"18\">18 全球化和本地化/安全管理/数据库维护</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><ul>\n<li>全球化和本地化</li>\n<li>安全管理</li>\n<li>数据库维护</li>\n</ul>\n<h3><span id=\"19-改善性能\"><span id=\"19\">19 改善性能</span></span><a href=\"2019/05/20/MySQL使用及调优#undefined\"></a></h3><ol>\n<li>SHOW VARIABLES; SHOW STATUS;  # 查看默认配置，是否需要修改配置</li>\n<li>SHOW PROCESSLIST;  # 查看所有活动进程（线程 ID /运行时间）</li>\n<li>总是有不止一种方法编写同一条SELECT语句。应该试验联结、并、子查询等，找出最佳的方法</li>\n<li>使用 EXPLAIN 语句让 MySQL 解释它将如何执行一条 SELECT 语句</li>\n<li>存储过程执行得比一条一条地执行其中的各条 MySQL 语句快</li>\n<li>应该总是使用正确的数据类型</li>\n<li>决不要检索比需求还要多的数据。换言之，不要用 SELECT * (除非你真正需要每个列)</li>\n<li>必须索引数据库表以改善数据检索的性能，是否索引根据数据表是查询多还是修改多</li>\n<li>select 语句的 or 子句 ===&gt; 修订为 多条 select 和 union</li>\n<li>LIKE 很慢。一般来说，最好是使用 FULLTEXT 而不是 LIKE</li>\n</ol>\n","prev":{"title":"Go Testing;How,What,Why","link":"2019/07/28/Go_Testing"},"next":{"title":"C++ 指针","link":"2019/05/13/指针_C++"},"plink":"http://yoursite.com/2019/05/20/MySQL使用及调优/","toc":[{"title":"数据库使用、调优</span>","id":"数据库使用-调优","index":"1","children":[{"title":"1 检索数据 select</span></span>","id":"1","index":"1.1"},{"title":"2 排序数据 select 语句的 order by 子句（默认生序）</span></span>","id":"2","index":"1.2"},{"title":"3 过滤数据 select 语句的 where 子句</span></span>","id":"3","index":"1.3"},{"title":"4 数据过滤 select 语句的 where 子句的（and/or、in/not in）子句</span></span>","id":"4","index":"1.4"},{"title":"5 通配符过滤（模糊查询）select 语句的 where 子句的 like 子句</span></span>","id":"5","index":"1.5"},{"title":"6 正则匹配 select 语句的 where 子句的 regexp 子句</span></span>","id":"6","index":"1.6"},{"title":"7 创建计算字段 concat/trim</span></span>","id":"7","index":"1.7"},{"title":"8 使用数据处理/汇总函数</span></span>","id":"8","index":"1.8"},{"title":"9 分组数据 select 语句的 group by / having 子句</span></span>","id":"9","index":"1.9"},{"title":"10 使用子查询 select 语句的 select 子句</span></span>","id":"10","index":"1.10"},{"title":"11 联结表 join</span></span>","id":"11","index":"1.11"},{"title":"12 组合查询 union</span></span>","id":"12","index":"1.12"},{"title":"13 插入数据 insert</span></span>","id":"13","index":"1.13"},{"title":"14 更新和删除数据 update/delete</span></span>","id":"14","index":"1.14"},{"title":"15 创建和操作表 create/alter/references</span></span>","id":"15","index":"1.15"},{"title":"16 使用视图 view</span></span>","id":"16","index":"1.16"},{"title":"17 存储过程/游标/触发器/事务处理</span></span>","id":"17","index":"1.17"},{"title":"18 全球化和本地化/安全管理/数据库维护</span></span>","id":"18","index":"1.18"},{"title":"19 改善性能</span></span>","id":"19","index":"1.19"}]}]}